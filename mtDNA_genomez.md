# Trying to map reads, extract mapped reads, and do denovo assembly.

## Trim ends
```
#!/bin/sh
#SBATCH --job-name=trimmomatic
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=96:00:00
#SBATCH --mem=8gb
#SBATCH --output=trimmomatic.%J.out
#SBATCH --error=trimmomatic.%J.err
#SBATCH --account=def-ben

# run by passing a directory argument like this
# sbatch ./2020_trimmomatic.sh ../raw_data/plate1


module load StdEnv/2020
module load trimmomatic/0.39

#v=1
#  Always use for-loop, prefix glob, check if exists file.
for file in $1/*_1.fq.gz; do         # Use ./* ... NEVER bare *
  if [ -e "$file" ] ; then   # Check whether file exists.
    echo java -jar $EBROOTTRIMMOMATIC/trimmomatic-0.39.jar PE ${file::-8}_1.fq.g
z ${file::-8}_2.fq.gz ${file::-8}_trim.R1.fq.gz ${file::-8}_trim.R1_single.fq.gz
 ${file::-8}_trim.R2.fq.gz ${file::-8}_trim.R2_single.fq.gz ILLUMINACLIP:TruSeq2
_and_3-PE-2.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
	java -jar $EBROOTTRIMMOMATIC/trimmomatic-0.39.jar PE ${file::-8}_1.fq.gz
 ${file::-8}_2.fq.gz ${file::-8}_trim.R1.fq.gz ${file::-8}_trim.R1_single.fq.gz 
${file::-8}_trim.R2.fq.gz ${file::-8}_trim.R2_single.fq.gz ILLUMINACLIP:TruSeq2_
and_3-PE-2.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
  fi
done 
```
## Map reads
```
#!/bin/sh
#SBATCH --job-name=bwa_align
#SBATCH --nodes=4
#SBATCH --ntasks-per-node=4
#SBATCH --time=96:00:00
#SBATCH --mem=32gb
#SBATCH --output=bwa_align.%J.out
#SBATCH --error=bwa_align.%J.err
#SBATCH --account=def-ben

# run by passing an argument like this (in the directory with the files)
# sbatch 2020_align_paired_fq_to_ref.sh pathandname_of_ref path_to_paired_fq_fil
ez
# sbatch 2020_align_paired_fq_to_ref.sh ../../2020_XL_v9.2_refgenome/XENLA_9.2_g
enome.fa.gz pathtofqfilez

module load bwa/0.7.17
module load samtools/1.10


for file in ${2}/*_trim.R1.fq.gz ; do         # Use ./* ... NEVER bare *    
    if [ -e "$file" ] ; then   # Check whether file exists.
	echo bwa mem ${1} ${file::-14}_trim.R1.fq.gz ${file::-14}_trim.R2.fq.gz 
-t 16 | samtools view -Shu - | samtools sort - -o ${file::-14}_sorted.bam
	bwa mem ${1} ${file::-14}_trim.R1.fq.gz ${file::-14}_trim.R1.fq.gz -t 16
 | samtools view -Shu - | samtools sort - -o ${file::-8}_sorted.bam
	samtools index ${file::-14}_sorted.bam
  fi
done
```
## Make new bam file with only mapped reads
```
#!/bin/sh
#SBATCH --job-name=samtools_mapped_only
#SBATCH --nodes=4
#SBATCH --ntasks-per-node=4
#SBATCH --time=96:00:00
#SBATCH --mem=32gb
#SBATCH --output=samtools_mapped_only.%J.out
#SBATCH --error=samtools_mapped_only.%J.err
#SBATCH --account=def-ben


module load bwa/0.7.17
module load samtools/1.10

samtools view -u -f 1 -F 12 SRR9611188_trim._sorted.bam > SRR9611188_trim._sorted_mapped_only.bam
```

## Extract mapped reads from bam file that has only mapped reads
Using bam2fastq (https://github.com/jts/bam2fastq)
```
./bam2fastq --aligned --force --strict -o mapped#.fq ../SRR9611188_trim._sorted_mapped_only.bam 
```
## NOVOplasty (config file below)
```
#!/bin/sh
#SBATCH --job-name=NOVOplasty
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=6:00:00
#SBATCH --mem=128gb
#SBATCH --output=NOVOplasty.%J.out
#SBATCH --error=NOVOplasty.%J.err
#SBATCH --account=def-ben


# This script will run NOVOplasty
# run like this sbatch 2021_NOVOplasty.sh config_file
module load StdEnv/2020 perl/5.30.2

perl NOVOPlasty4.3.1.pl -c ${1}
```

## (config file for NOVOplasty)
```
Project:
-----------------------
Project name          = SRR9611188_test
Type                  = mito
Genome Range          = 15000-22000
K-mer                 = 29
Max memory            = 120
Extended log          = 0
Save assembled reads  = no
Seed Input            = ./KJ567053.1_mulatta_India.fasta
Extend seed directly  = no
Reference sequence    = ./KJ567053.1_mulatta_India.fasta
Variance detection    = 
Chloroplast sequence  = 

Dataset 1:
-----------------------
Read Length           = 151
Insert size           = 300
Platform              = illumina
Single/Paired         = PE
Combined reads        = 
Forward reads         = ./SRR9611188_test/bam2fastq/mapped_1.fq.gz
Reverse reads         = ./SRR9611188_test/bam2fastq/mapped_2.fq.gz
Store Hash            =

Heteroplasmy:
-----------------------
MAF                   = 
HP exclude list       = 
PCR-free              = 

Optional:
-----------------------
Insert size auto      = yes
Use Quality Scores    = no
Output path           = 




Project:
-----------------------
Project name         = Choose a name for your project, it will be used for the output files.
Type                 = (chloro/mito/mito_plant) "chloro" for chloroplast assembly, "mito" for mitochondrial assembly and 
                       "mito_plant" for mitochondrial assembly in plants.
Genome Range         = (minimum genome size-maximum genome size) The expected genome size range of the genome.
                       Default value for mito: 12000-20000 / Default value for chloro: 120000-200000
                       If the expected size is know, you can lower the range, this can be useful when there is a repetitive
                       region, what could lead to a premature circularization of the genome.
K-mer                = (integer) This is the length of the overlap between matching reads (Default: 33). 
                       If reads are shorter then 90 bp or you have low coverage data, this value should be decreased down t
o 23. 
                       For reads longer then 101 bp, this value can be increased, but this is not necessary.
Max memory           = You can choose a max memory usage, suitable to automatically subsample the data or when you have lim
ited                      
                       memory capacity. If you have sufficient memory, leave it blank, else write your available memory in 
GB
                       (if you have for example a 8 GB RAM laptop, put down 7 or 7.5 (don't add the unit in the config file
))
Extended log         = Prints out a very extensive log, could be useful to send me when there is a problem  (0/1).
Save assembled reads = All the reads used for the assembly will be stored in seperate files (yes/no)
Seed Input           = The path to the file that contains the seed sequence.
Extend seed directly = This gives the option to extend the seed directly, in stead of finding matching reads. Only use this
 when your seed 
                       originates from the same sample and there are no possible mismatches (yes/no)
Reference (optional) = If a reference is available, you can give here the path to the fasta file.
                       The assembly will still be de novo, but references of the same genus can be used as a guide to resol
ve 
                       duplicated regions in the plant mitochondria or the inverted repeat in the chloroplast. 
                       References from different genus haven't beeen tested yet.
Variance detection   = If you select yes, you should also have a reference sequence (previous line). It will create a vcf f
ile                
                       with all the variances compared to the give reference (yes/no)
Chloroplast sequence = The path to the file that contains the chloroplast sequence (Only for mito_plant mode).
                       You have to assemble the chloroplast before you assemble the mitochondria of plants!

Dataset 1:
-----------------------
Read Length          = The read length of your reads.
Insert size          = Total insert size of your paired end reads, it doesn't have to be accurate but should be close enoug
h.
Platform             = illumina/ion - The performance on Ion Torrent data is significantly lower
Single/Paired        = For the moment only paired end reads are supported.
Combined reads       = The path to the file that contains the combined reads (forward and reverse in 1 file)
Forward reads        = The path to the file that contains the forward reads (not necessary when there is a merged file)
Reverse reads        = The path to the file that contains the reverse reads (not necessary when there is a merged file)
Store Hash           = If you want several runs on one dataset, you can store the hash locally to speed up the process (put
 "yes" to store the hashes locally)
                       To run local saved files, goto te wiki section of the github page

Heteroplasmy:
-----------------------
MAF                  = (0.007-0.49) Minor Allele Frequency: If you want to detect heteroplasmy, first assemble the genome w
ithout this option. Then give the resulting                         
                       sequence as a reference and as a seed input. And give the minimum minor allele frequency for this op
tion 
                       (0.01 will detect heteroplasmy of >1%)
HP exclude list      = Option not yet available  
PCR-free             = (yes/no) If you have a PCR-free library write yes

Optional:
-----------------------
Insert size auto     = (yes/no) This will finetune your insert size automatically (Default: yes)                           
    
Use Quality Scores   = It will take in account the quality scores, only use this when reads have low quality, like with the
    
                       300 bp reads of Illumina (yes/no)
Output path          = You can change the directory where all the output files wil be stored.
```

## Circularized mtDNA genome for SRR9611188
```
>Contig1
CTAAAACTGGTTTCAAGCCAATCTTATAGCCCCTATAACTTTTTCGGCAAGGTATTAGAAAAGTCATTTCGTAGCTTTGTCAAAGCTAAATCATAGGCCAAACCCTATATATCTTACATGGCC
CACCCAGTTCAACTAAGCCTACAAGAC
GCCACATCCCCTGTTATAGAGGAATTAATTACTTTCCATGACCATGCTTTTATAGCCATATCTCTAATCAGCTTCCTGGTATTATATGCCCTGCTCTCAACACTCACAACAAAACTAACCAAT
ACTAGCATCACAGATGCCCAAGAAATA
GAAACTATCTGAACTATCTTACCCGCAATTATCTTAATCCTAATTGCTCTCCCATCTCTACGTATCCTATACCTAACAGATGAAGTCAATGACCCATCCTTCACCATCAAATCAATCGGACAC
CAGTGATATTGAACCTACGAATACACG
GACTACGGGAGCCTAATTTTCAACTCCTACATACTACCTCCATTATTCCTAAACCCAGGGGACCTCCGACTCCTAGAAGTTGACAATCGGGTAGTCCTTCCAATTGAAGCTCCTGTACGTATA
ATAATTACATCTCAAGACGTCCTACAC
TCATGAACTATCCCCACACTAGGCCTAAAAACAGACGCCGTACCTGGGCGTCTAAATCAAACCGTTTTCACGGCTACACGACCAGGCGTCTATTACGGACAATGCTCAGAAATCTGTGGCGCA
AATCATAGCTTCATACCAATTGTTGCA
GAGCTAATCCCACTAAAAATCTTTGAAATAGGACCTGTATTTACTCTGTAAACAACCCTGCCCACTCTCTTTTTTCCCCCAACACCCCTCTCCCACCCCATAAACCCTCAAAACACTCTACAA
ACTCACTGTATAGCTATCTTAGCATTA
ACCTTTTAAGTTAAAGACGGGGGACACACCCCCTACAGTGAAATGCCCCAGTTAGATACATCAACATGATTCACCACTATTATGACGATGCTTCCCACACTATATCTTATCATGCAGCTAAAG
CTACTAAACACAAATCACCACCAACCA
CCCCTTACAAAAACCCCCACCCTTCAGTCTCACAATGTCCGCTGACAACCAAAATGAACGAAAACTTGTTTACCCCTTTCTCAGCCCCAACAATTCTAAACCAACCCGCTACAATCCCCATTA
TCCTATTCCCCACCCTACTAATCTTAA
CCCCCAAACATCCCATTAATAATCGACTAGCTACCATTCAACAAAATCTGACTCGATTCACTCTAAAACAAATAATAATAACTCACAACGCTAAGGGACAAACCTGATCCTTAATACTAACAT
CCCTAATCACCTTTACTGCTACAACAA
ACCTCCTAGGACTTATGCCTTACTCGTTCACGCCAACTACCCAACTTTCCATAAACCTAGCTATAGCAATCCCCCTATGAGCGGGCACAGTAATAGTGGGGCTTCGCTTTAAAACCAAAAACT
CCCTAGCCCACCTCCTACCACAAGGCA
CACCCACACCTCTCATTCCTATGCTAGTAGCAATCGAAACTATCAGTCTACTTATTCAACCAGTGGCTCTAGCCGTACGATTAACCGCAAACATCACAGCCGGCCATCTGCTAATACACCTGA
TCGGAAACACTGTACTAGCACTATCAA
CCACCAACCTCTCCATAGCTCTACTAGCCTCTACACTTCTGGTATTACTAACTATTCTAGAAATTGCAGTAGCCCTAATTCAAGCCTATGTCTTCACACTCTTAATTAGCCTTTATCTACGGA
ACAACACCTAATGACCCACCAGACCCA
CGCTTATCACATAGTTAAACCCAGTCCCTGGCCGCTGACAGGAGCTCTGTCAGCCTTCTTAATAACATCTGGCTTAGTCATGTGATTTCACTTCTACTCCACCACCCTACTAATACTAGGCCT
ACTAACCAATACACTAACCTTATACCA
ATGATGACGCGACATTGTACGAGAAAGCACATACCAAGGCCACCACACAACACCCGTCCAAAAAAGCCTTCGGTACGGAATAACACTATTCATCATCTCAGAAGCATTCTTCTTTGTCGGCTT
CTTCTGAGCATTTTACCACTCAAGCCT
TGCTCCAACACCCTGCTTAGGAGGCCATTGACCACCAACAGGCATCACCCCTCTAAACCCCATAGAAGTACCCCTCCTAAACACCTCTGTATTACTTGCATCCGGAGTTACAATTACCTGAGC
TCATCACAGTCTCATAAACAACGATCG
AAAACAAACAATCCAAGCCCTACTCATCACAATCCTACTCGGCACCTATTTCACCCTACTACAAATCTCAGAATACTTTGAAGCACCCTTCACCATCTCCGATGGCATCTACGGTTCAACATT
CTTCATTACCACAGGCTTCCATGGACT
CCACGTTATTATTGGATCCACATTCCTCTTTGTCTGCCTCATCCGCCAACTACTACACCACTTCACATCGAACCATCACTTCGGCTTCGAAGCCGCCGCTTGATATTGACACTTCGTGGATGT
TATCTGACTACTCCTTTATATTTCTGT
CTATTGATGAGGATCCTACTCTTTTAGTATAACAAGTACAATTGACTTCCAATCAATCAGTTTTGACAACATTCAAAAGAGAGTAATTAATCTAGTGCTAGCCCTAACAATCAACACCCTATT
AACCTCGCTACTGATAATTATCATATT
CTGACTACCCCAGCTCAACCCCTATACAGAAAAAACCAGCCCCTACGAGTGCGGATTTGACCCCCTAAACCCTGCTCGCATCCCATTCTCAATAAAATTCTTCCTAGTTGCCATTACTTTCCT
GCTATTTGACCTAGAAATCGCCCTACT
ACTATCTCTACCGTGAGCCATTCAAACAACAAACCTCCCAATAATAATCAAATCGACCATTGCCTTTATTATTATCCTAATTCTCAGTTTAACCTATGAATGAACCCAAAAAGGGTTAGACTG
GGCCGAATTGGTAAGTAGTTTAAATAA
AATAAATGATTTCGACTCATTAGATTATGATAACCATACTAACCAAATGACCCTTACCTATATAAACATTATACTAGCATTCGCTATCTCTCTTCTAGGTATACTAACCTACCGCTCACACCT
AGTAGCCTCTCTCCTCTGCCTAGAGGG
AATAATAATATCGCTCTTTATTATGGCCACCCTTATTGCCTCAAACACACACTTCCCCCTAATCAACATTATACCCATCATTTTGTTAGTATTTGCCGCCTGTGAAACAGCAGTAGGTCTTGC
CCTACTAATCTCAATCTCCAACACATA
CGGACTAGACTACGTCCACAACCTAAACCTGCTTCAATGCTAAAAATAATTATTCCCACAACCATACTACTACCCATAACATGACTCTCTAAAAATAATACAATTTGAATCAACTTGACCATG
CATAGCTTAACTATCAGCCTCATCCCC
TTACTATTCTTCAACCAAACCAGCACCAACCTCCTCAATCACTCAACCTATCTATCTTCTGACCCACTAGCAGCACCCCTCCTAACACTAACTATCTGACTTCTACCCCTCATGATTATAGCG
AGCCAGTATCACCTATATAACGAACCC
CCCTCACAAAAAAAACTTTTCCTCTTCACAATAATTCTCCTACAAATCACCCTAATTCTGACATTCATGGCCACAGAGCTAATTATATTCTACATTCTATTTGAAACCACCCTAATTCCCACC
CTAATTATCATTACTAAATGGGGCAAC
CAAGCAAAACGCCTCAACGCAAGTACCTACTTTCTATTCTATACACTAACCGGCTCTCTACCCCTACTCATCATACTAAGCCACACCTACAACAACACAGGCTCATTAAATATTACATTACTA
ACACTCACAGACCAAAAACTAACAACC
ACCTGATCTCACAACTTTACCTGACTAGCATGCATAATAGCCTTTATGACAAAAATACCCCTATATGGCCTACACCTGTGACTTCCTAAAGCCCATGTCGAAGCCCCCATTGCAGGATCAATA
GTCCTTGCCGCAGTACTCCTAAAACTA
GGTGGCTACGGCATAATACGACTTACTCCCATCCTTAACCCCTTAACAGAATACATAGCTTACCCATTCCTCATATTATCCTTATGGGGCATAATCATAACAGGCCTAACATGCCTCCGACAA
ACAGATCTAAAATCACTTATCGCATAC
TCTTCTGTAAGCCACATGGCCCTTGTAATTGTAGCCTCTCTCATCCAAACCCCCTGAAGCTTTTCCGGCGCAACCATCCTTATAATCGCTCACGGACTCACCTCTTCCATGTACTTCTGCCTA
GCCAATTCAAACTATGAACGCACCCAC
AGCCGTACCATACTACTGTCCCGAGGACTTCAAATCCTACTCCCACTAACAGCCTTCTGATGATTAACAGCAAGCCTTACTAACCTTGCCCTGCCCCCCACTATCAACCTACTAGGCGAACTC
TTTGTAATCACGACCTCATTTTCCTGA
TCCCATATCACCATTATGTTGACAGGGCTTAATATACTAATTACGGCCCTCTACTCTCTCCACATATTCATTACAACGCAACGAGGAATACTTACACACCATATAATCAACATAAAACCCTCC
TTCACACGAGAAAATATATTAATATTC
ATACACTTCGCCCCAATTATCCTTCTGTCTCTCAATCCCAACATCATCCTAGGATTTACCTCCTGTAGATATAGTTTAACTAAAACATTAGATTGTGAATCTAACCACAGAGACTTACCACCT
CTTATTTACCGAGAAAACTCACAAGGA
TTGCTAACCCATGTACCCGTACCTAAAATTACGGTTTTCTCAACTTTTAAAGGATAACAGCTATCCATTGACCTTAGGAGTCAAAAACATTGGTGCAACTCCAAATAAAAGTAATAACCATGC
ACACCCCCATCATAATAACAACCCTTA
TCTCCCTAACCCTCCCAATTTTTGCCACCCTCATCAACCCTTACAAAAAACGTCCATACCCAGATTACGTAAAAACAACCGTAATATATGCTTTCACCATCAGCCTCCCCTCAACAACCTTAT
TCATCTTCTCGAACCAAGAAACAACCA
TTTGGAGCTGACATTGAATAATAGCCCAAACATTAGACCTAACACTAAGCTTCAAACTAGATTACTTCTCCATGATATTTATTCCAATCGCACTATTCATCACCTGGTCCATCATAGAATTCT
CGCTATGATACATAAACTCAGACCCAA
ACATCAACCAATTCTTCAAATATCTTCTTATTTTCCTCACTGCCATACTAATTCTAGTCACTGCTAACAACCTCTTCCAATTCCTTATCGGCTGAGAGGGCGTAGGAATCATATCTTTTCTCC
TAATTAGCTGATGATACGCTCGAACAG
ACGCCAACACAGCAGCCATCCAAGCAATCTTATATAATCGCATTGGCGACATTGGTCTTATCCTAGCCATAGCATGATTTCTCCTACATTACAACTCATGAGACCTCCAACAAATACTAGCCC
TAAATTTCAACTCAAGCTCCCTCCCAC
TAATAGGCCTCCTCCTAGCAGCAGCAGGAAAATCAGCTCAATTCGGTCTTCACCCCTGACTACCCTCTGCCATAGAAGGCCCAACTCCAGTCTCAGCCCTACTTCACTCCAGTACCATAGTCA
TTGCCGGAGTGTTCTTACTCATCCGCT
TCCACCCTCTAATAGAAACCAACACAATAATTCAAAATCTTACATTATGCCTGGGGGCTATTACTACCCTATTTACAGCCATCTGCGCCCTTACACAAAACGACATTAAAAAGATTGTAGCCT
TCTCCACCTCAAGCCAACTAGGCCTAA
TAATAATCACCATCGGCATCAACCAACCATACTTAGCATTCCTACACATCTGCACCCATGCTTTCTTTAAAGCCATACTTTTTATATGCTCCGGATCCATTATCCATAACCTAAACAACGAAC
AAGACATTCGAAAAATAGGAGGCCTAT
TCAAAACAATACCCCTCACCTCAACTTCCATAATCATTGGCAACCTAGCACTCACAGGAATACCCTTCCTCACAGGCTTCTACTCCAAAGACCTTATTATCGAAGCCACAAACACGTCGTACA
CCAACGCCTGAGCCCTATTCATCACTC
TCATCACTACCTCTCTAACAAGCGCCTATAGCACTCGAACTATCCTTCTCACCCTAACAGGACAACCCCGTTTTCCAGCCCTAACAAACATCAACGAAAACAACCCCGCTCTACTAAACCCAA
TTAAACGCCTCACAATGGGCAGCATAA
TCACAGGATTTCTTATCACCAACAACATCCCCCCCACCTTACTCCCCCAACCAACAATACCCCTCTACTTAAAACTCTCAGCTCTATGCGCAACTGTCCTAGGCTTCCTAGCAGCCCTAGACC
TCACCCTTATAACAAACAAACTGAAAA
TAAAAAACCCATCACAAATATTCAAATTCTCCAATATACTAGGATATTTTCCCACCACAATTCACCGCACAATCCCCTATCAAAACCTACTCATAAGCCAAAATTTAGCCCTTCTCCTATTGG
ATTCAGCATGACTAGAGAAATCTATAC
CTAAAATAATCTCACAAGCACACATTACTGCCTCCATAACTGTAACCACCCAAAAAGGCATAATCAAACTCTACTCCCTTTCTTTCCTCATCCCCCTTACCCTAGCCCTAATTCTAATGATAT
AACCTATTACCCCGAACAATCTCAATC
ACAACATACACACCAACAAATAATGTCCAACCAGCAACTACCACTAATCAACGCCCATAATCATATAAGGCACCCGCACCAATAGAATCACCTCGAATCAATCCTGACCCCTCCCCCTCAAAA
ATCACCCAATCACCAGTATCACTAAAA
CTAACCACCACTTCTACCGCCTCATCCAAACTTAAAACCCATAAAACTAATATCACCTCCATTATCAACCCTACTAAAAGACCCCCTAAAACCTCAAACCCCGAACCCCATGTCTCAGGATAC
TCTTCAATAGCCATTGCAGTAGTATAA
CCAAAAACAACCATCATACCCCCCAGATAAACTAAAAACATCATCAAACCCATATAAGCCCCCCCACAACTTAAAACAATCACACAACCAATCACACCACTAACAATTAACGCCAGACCCCCA
TAAATAGGAGAAGGCTTAGAAGAAAAC
CCCACAAACCCCATAACTAATAAAACACTCAATGCAAACAAAATATACGTCATTGCTTTCACATGGACTCCAACCATGACTAATGGTACGAAAAACCATCGTTGTATTTCAACTATAAAAGCA
CCAATGACTCCAATACGCAAATCCAAC
CCAATCCTAAAAATAATTAATCGCTCCTTCATCGATTTACCCGCCCCACCCAACCTCTCCATATGGTGAAACTTTGGCTCACTTCTTGCAGCCTGCCTAATTTTACAAATCATCACAGGCCTA
CTCCTAGCAATACACTACTCACCAGAC
ACCTCCTCCGCCTTCTCCTCAATTGCACATATCACCCGAGATGTAAAGTACGGCTGAATCACTCGCTACCTCCACGCCAATGGTGCCTCTATACTCTTCATTTGCCTTTTCCTACACATCGGT
CGGGGCCTTTACTACGGCTCATACCTC
CTCCTAGAAACCTGAAACATTGGTATTATACTCCTTCTTATAACTATAACAACGGCTTTCATGGGTTATGTTCTCCCATGAGGCCAAATATCATTCTGGGGAGCAACAGTAATCACAAACCTG
CTATCAGCAATCCCGTATATCGGAACC
AATCTCGTCCAATGAATCTGAGGAGGATACGCCATCGACAGCCCTACTCTCACACGATTCTTCACCTTACACTTTATCCTACCCTTCATCATCATCGCCCTCACAACCGTGCACCTACTATTC
CTGCACGAAACAGGATCAAACAACCCT
TGCGGAATCTCCTCCGACTCAGACAAAATCGCCTTCCACCCCTACTACACAACCAAAGACATCCTGGGCCTAGTCCTCCTTCTCTTCATCCTAGCAACACTAACACTACTCTCACCCAACCTC
CTAAACGACCCAGACAACTACATTCCA
GCCGACCCATTAAACACTCCCCCACATATCAAACCAGAGTGATACTTCCTATTTGCATACACAATCCTACGATCCATCCCCAACAAACTGGGAGGCGTACTAGCACTCTTTCTATCGATCCTC
ATTCTAGCAGCCATCCCTATACTTCAC
AAATCCAAACAACAAAGCATAATATTCCGCCCACTCAGCCAATTTCTATTCTGACTCCTAATCACAATCCTATTGACCCTTACCTGAATTGGAAGCGAACCAGTAGTCCAACCCCTTACCACT
ATCGGCCAAGTAGCATCCATAATATAC
TTCATCACAATTCTAATCCTAATACCACTGGCCTCCCTAATCGAAAACAACCTACTCAAGTGAACTTGCCCTCGTAGTATAAATTAGTACACTGGCCTTGTAAACCAGAAATGAACACTCTTC
CTAGGGCAGTCAGAAAGAAAGTACCTA
ACTCCACCACCAACACCCAAAGCTGGCATTCTAATTTAAACTACTTTCTGCATTCTTATATTGCATAAGCTTCATAAATAACTCTAGCACCAATCCACCCATAATACTACTATGTAATTCGTG
CATTACTGCTAGCCAACATGTATAATA
TATAGTACTATATATGCTTAACTGTACATAACACATATTATTACATACCAACTTGACATTCCAAACAGCATGCTTACAAGCAAGTATCCTAATACAAACCTCAACAGTAACACATAACATGGT
TCCCTCGGACTTAACTTGTCCCCCCCC
ATGAATATCAACTGAACCAGTCCTTGCCAGTCGTCCATAGTACATTAAGTCGTTCATCGGACATAGCACATATCTATTAAATAATCCTCCTCACCACGGATGCTCCCCTTCACTTAGGAGTCC
CTTACTCACCATCCTCCGTGAAATCAA
TATCCCGCACAAGAGTGCTACTCTCCTCGCTCCGGGCCCATAACTCGTGGGGGTAGCTATACCTGAACTGTATCCGGCATCTGGTTCTTACCTCAGGGCCATAACAATCAAGATCGCCCACAC
GTTCCCCTTAAATAAGACATCTCGATG
GATCACGGGTCTATCACCCTATTAACCAGTCACGGGAGATTTCCATGCATTTGGTATCTTTTATCTCTGGTCTGCACGCAACCCCATTGCAGAATGCTGACTCCCACCACATCCCGTCCTGTA
TGCGCCTGTCTTTGATTCCTAGTACAT
GCAGTTGTTGATCGCACCTACGTTCAATATTCTAGCTCCACGCAAACCTTAGCAAGGTGTTATTTAATTCATGCTTGTAGGACATACCAATAATCATCCCAGCCGACACCACACCACACCACC
AATCACTAACCGTATCTTATCAAACCC
CCCCACCCCCATCTCCGACCTTCATCCAAACCCCACTCTTGCCAAACCCCAAAAACAAAAGTCTTAACATATCCGATCAGAGCCTATATTTCCATCTTTTAGGTGTGCACAACTCCAACTGCC
ACTCCCTCAACTAATAAACATTTACTT
CACTAAACACCCTCTACACCAACCCGCAACAAATCCTTCTCATACAACCCGAAAGAGGCTGCCTCACAACTATACTAGCACCTTTGTTTATGTAGCTTAAACCCACCCAAAGCAAGACACTGA
AAATGCCTAGATGGGTTTGCACACCCC
ATAAACATATAGGCTTGGTCCTGGCCTTTCTATTAGCTCTTGGCAGGATTACACATGCAAACATCCTCGCTCCGGTGAAGACGCCCTACAAATCATCATGACCAAGAGGAGCAAGCATCAAGC
ACGCGCACGCAGCTCAAAACGCTTTGC
CTAGCCACACCCCCACGGGAGACAGCAGTGACAAATATTTAGCAATAAACGAAAGTTCAACTAAGCCATGCTATATTTAGGGTTGGTCAATTTCGTGCCAGCCACCGCGGTTACACGATTAAC
CCTAGCTAATAGAGACCGGCGTAGAGG
GTGTTTAAGATCTGATATAATAAAGCTAAACTCCATCTAAACTGTAAAACTCTAGCTGATGTAAAATAAACTACGAAAGTGGCTTTAAAGCTTCTGAACACACAATAGCCAGGACCCAAACTG
GGATTAGACACCCTACTATGCTTGGCC
CTAAACCTCAGTAGTTAGATAACAAAACTACTCGCCAGAATACTACAAGCTATAGCTTAAAACTCAAAGGACTTGACGGTGCTTTACACCCCCTAGAGGAGCCTGTTCCGTAATCGATAAACC
CCGATCCACCCCACCCTCTCTTGCTCA
GCCTATATACCGCCATCTTCAGCAAACCCTAATGAGGGTCACAAAGTGAGCGCAAATGCCATTGCCGCAAACACGTTAGGTCAAGGTGTAGCCTATGAGACGGTAAAAAATGGGCTACATTTT
CTACCTCAGAAAATTCCACGAAAACCC
TTATGAAATTTAAGGGTCCAAGGAGGATTTAGCAGTAAATTAAGAATAGAGTGCTTAATTGAACCAGGCCATAAAGCGCGCACACACCGCCCGTCACTCCTCTCAAATATATTTAAGGAACAT
CTTAACTAAACGCCCTAATATTTATAT
AGAGAGGATAAGTCGTAACATGGTAAGCGTACTGGAAGGTGCGCTTGGATAAATCAAGGCATAGCTTAATATAAAGCACCTGGCCTACACCCAGAAAATCTCAATACCACTTGATTGCCTTGA
GCCAATACTAGCCCTAAGCATAACCAA
CACTAATACCAAACTAACACGCACTAAACCATTCACCTACACAAAGTATAGGCGATAGAAATTTTAATCTGGCGCTATAGACGCAGTACCGTAAGGGAAAGATGAAACCACCCAAGCACAAAA
CAGCAAGGACTAACCCCTGTACCTTTC
GCATAATGAATTAGCTAGAAACAATTTCACAAAGAGAACTACAAGCCAAATTCCCCGAAACCAGACGAGCTACCCAAAAACAGCTAAAAGAGCGCACCCATCTATGTGGCAAAATAGTGGGAA
GATTTCTGGGTAGAGGTGACAAGCCTA
CCGAGCCTGGTGATAGCTGGTTATCCAAGACAGAATCTTAGTTCGACCTTAAGCTTACCTATAGAACCACCTAATCTCCCTGTAAGCTTAATTGCTAGTCTAAAGAGGGACAGCTCTTTAGAC
ACTAGGAAAAAACCTTATAGAGAGAGT
AAAATCCTCAATTACCATAGTTGGCTTAAAAGCAGCCATCAATTAAGAAAGCGTTCAAGCTCAACACTAACCACCCCAAAAATACCAAACACATAGCTGAACTCCTCACACCACATTGGATTA
ATCTATCACCATATAGAAGCAATAATG
CTAGTATAAGTAACATGAATATTTTCTCCACTGCATAAGCCCAAATCGGATCGAAAACCTCACCGATACCTAACAGCCAGGCATAGCAAGCACAAACAAGCCCATGCTACCTTCACTGTTAAC
CCAACACAGGCATGCCTCAAGGAAAGG
TTAAAAAAAGTAAAAGGAACTCGGCAAACCTAAACCCCGCCTGTTTACCAAAAACATCACCTCTAGCATTACTAGTATTAGAGGCACTGCCTGCCCAGTGACACACGTTTAACGGCCGCGGTA
CCCTGACCGTGCAAAGGTAGCATAATC
ACTTGTTCTTTAAATGGGGACTCGCATGAAAGGCACCACGAGGGTTTAACTGTCTCTTACTTTTAACCAGTGAAATTGACCTGCCCGCGAAGAGGCGGACATAGTATAATAAGACGAGAAGAC
CCTATGGAGCTTTAATCTATTAATGCA
ATCAAAAATTACACAAACCCACGGACCTTTAAACTATCGACACCTGCATTAAAAATTTTGGTTGGGGCGACCTCGGAGCACAACAAAACCTCCGAATAACACATGCTAAGACCACACAAGTCA
AAGCGAACTAACACTTATAATTGATCC
AATAACTTGATCAACGGAACAAGTTACCCTAGGGATAACAGCGCAATTCTATTCTAGAGTCCATATCGACAATAGAGCTTACGACCTCGATGTTGGATCAGGACATCCTAATGGTGCAGCAGC
TATCAAGGGTTCGTTTGTTCAACGATT
AAAGTCCTACGTGATCTGAGTTCAGACCGGAGCAATCCAGGTCGGTTTCTATCTATTGCACATTTCTCCCTGTACGAAAGGACAAGAGAAATAAGGCCCACTTCACAAAGCGCCTTCACTACA
TAAATGACCTAGTCTTAATTTAGCAAA
ATACCACACATTCCACCCGAAAACAGGGTTTGTTAAGATGGCAGAGCCCGGTAATTGCATAAAACTTAAAACTTTGTAACCAGAGGTTCAATTCCTCTTCTTAACACCATGACCACAGTAAAT
CTCCTACTTATAATCATACCCACATTA
GCCGCCATAGCATTTCTCACACTCGTTGAACGAAAATTACTAGGCCACATGCAACTACGAAAAGGGCCCAATATTGTAGGTCCATGCGGACTATTACAACCCTTCGCCGATGCCGTAAAACTT
TTCACTAAAGAACCCCTGAAACCCGCA
ACATCTACCACCATCCTCTATGTCGTCGCACCTGCTCTAGCCTTCTTCATTGCCCTCCTCCTATGAACCCCCCTCCCCATACCCAACGCTCTAATCAACTTCAACCTAGGGCTCCTATTCATC
CTAGCCATACTCAGCCTAATTGTCTAC
TCCATCCTATGATCAGGATGAGCATCAAACTCAAACTACGCCCTAATCGGAGCTCTGCGAGCCGTCGCCCAAACAATTTCATATGAAGTCACCCTTACTATTATCCTCCTATCAGTCCTACTA
ATAAGCGGCTCATTTAACCTTAACACA
CTCATTACAACGCAAGAGCATCTATGACTCCTCCTACCATCATGACCCCTAGCCATAATATGATTTACCTCCACACTAGCAGAAACAAACCGAACCCCTTTTGATCTCATAGAGGGCGAATCA
GAATTAGTATCAGGCTTCAACATTGAA
TACGCCGCAGGTCCATTCGCCCTATTCTTCATAGCCGAATACACAAACATCATCATAATAAACGCCCTAACAACCACAATCTTCCTAGGCACATCCCACTCCACTTATTCACCAGAACTATTC
ACAACATGCTTCGCCACCAAAACACTC
TTCCTAACCTCCCTATTCCTATGAATCCGGGCAGCATACCCCCGATTCCGTTACGACCAACTTATACACCTACTATGAAAAAACTTCCTCCCCCTCACACTAGCACTACTCATATGATCCACC
TCAATACCCATCGCAATCTCCAGCATT
CCCCCTCAAACCTAGAAATATGTCTGACAAAAGAGTTACTTTGATGGAGTAAATAATAGAGGCCCCAATCCTCTTGTTTCTAGGACTGTAGGTATCGAACCTACCCCTGAGAATCCAAACTTC
TCCGTGCTACCCTACACACTCTATCCT
AAAGTAAGGTCAGCTAAACAAGCTATCGGGCCCATACCCCGAAAATGTTGGTCACATCCTTCCCGTACTAATTAACCCACTAGCTCAACCCATTATCTACACCACAATAATCACAGGCACACT
TATCACAACACTAAGCTCACACTGATT
TCTCGCCTGAACAGGCCTAGAAATAAACATACTAGCTTTCATTCCGATCTTAATAAAAAAAACAAGCCTCCGCTCCACAGAAGCCGCTACTAAATACTTCCTAATTCAATCTACCGCATCTAT
AGTCCTCATAATAGCAATCATCTCCAA
CAACCTGCTATCAGGGTGCTGAACAACAACGAACTACATCAGCCAACCCCCATCCCTAATAATAACAACCGCCCTCGCCATAAAACTAGGAATAGCCCCCTTCCACTTCTGAGTCCCAGAAGT
CACCCAAGGAACACCCCTAACCTCAGG
TCTACTCCTTCTTACATGACAAAAACTAGCCCCCATCTCAATCATGTACCAAATTCACCCATCAATCAACACCCACATCCTCCTAACCCTCTCCACCCTATCCATTGCAGTAGGCAGTTGAGG
AGGTCTAAACCAAACACAATTACGCAA
GATCCTAGGGTACTCTTCAATCACACACATGGGTTGAATAATGATAACACTTGTATACAACCCAGCAACTACAATTTTCTATTTAACTACATACATTATCCTAACAACTACCATATTCCTAAC
CCTCAACTTAAGCTCAAGCACCACAAC
CCTCATACTATCCCGCACCTGAAACAAATCAACCCACCTAGCACCGCTAATAGCACCCATTCTCATATCTCTAGGAGGCCTACCACCCCTAACCGGCTTCCTACCTAAATGAATTATCATCCA
AGAACTCACAATGAACAACAACTTCCT
CATCCCCTCTATTATAACTATCATAACCCTACTTAACCTATACTTTTATATACGCCTAATCTACACCACCTCCCTAACGCTATTCCCTACATCCAACAACACAAAAATAACATGACAACTCGA
AAATACAAAACCCACACTCCTTATCCC
CCCACTCATCATCACCTCCACTCTTCTACTACCAATCTCCCCCCTACTCTTAACCCTTCACTAGAAATTTAGGTTAAACAAGACCAAGAGCCTTCAAAGCCCTTAGTAAGTAAAAACACTTAA
TTTCTGAAACACATAAGGACTGCAAAC
ACCTACTCTGCATCAATTGAACGCAAATCAACCACTTTAATTAAGCTAAGCCCTTACTAGATCAATGGGACTCGAACCCACAAAAACTTAGTTAACAGCTAAGCACCCTAACCGACTGGCTTT
GACCCACTTCTCCCGCCGCAGGGAGAA
AAAGGCGGGAGAAGCCCCGGCAGAAACTCTAAGACTGCTCCTTTGAACTTGCAATTCAACATGAAAATCACCTCGGGGCTGGTAAAAGGGGGACTAAACCCCCGTCTTTAGGTTTACAGCCTA
ATACTTACTCAGCCATTTTACCACTTA
TGCTCATTAATCGCTGACTCTTTTCAACAAATCACAAAGACATTGGAACCCTGTATTTACTATTTGGTGCATGAGCTGGAATCATAGGCACTGCCCTAAGCCTCCTCATTCGAGCTGAACTAG
GCCAACCCGGCAACCTACTAGGCAACG
ACCACATCTATAACGTTATTGTAACGGCCCATGCATTTGTCATAATTTTCTTTACAGTCATACCCATTATAATTGGAGGGTTCGGGAACTGACTAGTACCCCTAATAATCGGCGCCCCCGACA
TAGCATTCCCCCGTCTAAACAATATGA
GCTTCTGACTCCTCCCCCCTTCTTTCCTGCTACTAATAGCATCCGCCGTGGTAGAAGCTGGCGCCGGAACAGGCTGAACAGTATACCCCCCTCTAGCAGGAAACTTCTCCCACCCAGGAGCTT
CTGTAGATTTAGTCATCTTCTCTCTTC
ACCTAGCAGGTATTTCCTCTATCTTAGGAGCCATCAACTTCATTACCACCATTATCAACATAAAACCCCCCGCAGTATCCCAATACCAAACCCCTTTATTTGTCTGATCAATCTTAATCACAG
CAATCCTTCTACTCCTCTCTCTACCAG
TTCTAGCCGCCGGCATTACCATGCTACTAACAGATCGCAACCTCAATACTACTTTCTTTGACCCTGTTGGAGGAGGAGACCCTATCCTATATCAACACCTATTCTGATTCTTTGGTCACCCGG
AAGTCTACATCCTTATTCTCCCCGGCT
TCGGAATAGTCTCCCACATTGTAACCTACTACTCTGGGAAAAAAGAACCATTTGGGTACATGGGTATAGTTTGAGCCATAATATCAATTGGGTTTTTAGGTTTTATTGTATGAGCCCACCACA
TGTTTACAGTTGGCATAGACGTAGATA
CACGAGCCTATTTCACCTCCGCCACTATAATCATTGCAATCCCCACCGGTGTGAAAGTTTTTAGCTGGCTTGCTACACTTCATGGGGGCAACATCAAATGGTCCCCAGCAATACTTTGAGCCC
TAGGCTTTATCTTCCTATTTACTGTAG
GGGGTCTAACTGGCATCATCTTAGCAAACTCATCCCTAGATATCGTACTACACGATACATACTACGTTGTCGCCCACTTTCATTATGTTCTATCAATAGGAGCTGTATTCGCCATTATGGGGG
GCTTTATACACTGATTCCCTTTATTCT
CAGGCTACACACTGAACCAAACCTGTGCCAAAGCCCACTTCATCATTATATTCATGGGCGTAAATTTAACCTTCTTTCCACAACACTTCCTTGGCCTGTCCGGAATACCCCGACGCTACTCTG
ATTATCCCGATGCCTACACTACATGAA
ATACCCTATCATCTATAGGCTCCTTCATCTCACTAGTAGCAGTAATTTTAATAATCTACATGATCTGAGAAGCCTTTGCTTCAAAACGTAAAGTACTACTAATCGAACAACCCCTTACTAACC
TAGAGTGACTAAATGGCTGCCCCCCGC
CTTATCACACATTCGAAGAACCACCCTACATTAAACTAGTCGAAAAAGGAGGGAGTCGAACCCC
```


# BEAST
I'm running 8 independent runs; sbatch below.
```
#!/bin/sh
#SBATCH --job-name=beast
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=5:00:00
#SBATCH --mem-per-cpu=4000M
#SBATCH --output=beast.%J.out
#SBATCH --error=beast.%J.err
#SBATCH --account=def-ben

# sbatch Beast.sh file
BEAST_MEM="-Xmx3750M"
# Define variables where to find BEAST and BEAGLE-lib
BEAST_LIB="${EBROOTBEAST}/lib"
BEAST_EXTRA_LIBS="${BEAST_LIB}:${BEAGLE_LIB}"
export LD_LIBRARY_PATH="${BEAGLE_LIB}:${LD_LIBRARY_PATH}"


module load StdEnv/2020  gcc/9.3.0 beast/2.6.3
module load java
# Build a long java command:
CMD="java -Xms256m ${BEAST_MEM}"                   # set memory
CMD="$CMD -Djava.library.path=${BEAST_EXTRA_LIBS}" # point to libraries
CMD="$CMD -jar ${BEAST_LIB}/launcher.jar"             # which program to execute

echo ".................................."
echo "The Java command is \"${CMD}\""
echo ".................................."

# Run the command:
$CMD -beagle ${1}
```
